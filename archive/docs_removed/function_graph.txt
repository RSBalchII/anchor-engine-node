# Function Graph: Context-Engine Architecture

## Directory Structure
C:\Users\rsbiiw\Projects\Context-Engine/
├── anchor/
│   ├── specs/
│   │   ├── spec.md
│   │   ├── plan.md
│   │   └── tasks.md
│   └── README.md
├── backend/
│   ├── specs/
│   │   ├── spec.md
│   │   ├── plan.md
│   │   └── tasks.md
│   └── src/
│       ├── context.py (ContextManager)
│       ├── graph.py (GraphReasoner)  
│       ├── distiller_impl.py (Distiller)
│       ├── memory/
│       │   └── neo4j_store.py (Neo4j integration)
│       └── agents/
│           └── archivist.py (ArchivistAgent)
├── specs/ (global specs)
│   ├── spec.md
│   ├── plan.md
│   └── tasks.md
├── extension/ (browser bridge)
└── README.md (root)
└── CHANGELOG.md

## Class Interactions
ContextManager → Distiller (for content compression)
ContextManager → Neo4jStore (for gist persistence) 
ContextManager → GraphReasoner (for retrieval logic)
GraphReasoner → Neo4jStore (for query execution)
ArchivistAgent ← ContextManager (for maintenance coordination)

## Function Flow
1. User Input
   ↓
2. ContextManager.build_context()
   ↓
3. ContextManager.check_and_rotate_context() (when >55k tokens)
   ↓
4. Distiller._chunk_and_distill() (compresses old context)
   ↓
5. Neo4jStore.add_memory() (stores as :ContextGist nodes)
   ↓
6. GraphReasoner._retrieve_subgraph() (includes ContextGist search)
   ↓
7. LLM Response Generation